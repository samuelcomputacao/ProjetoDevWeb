{"ast":null,"code":"var _jsxFileName = \"/home/samuel/Documentos/repositorios/ProjetoDevWeb/frontend/src/protected/components/FormUsuario/index.js\";\nimport React, { useState, useEffect } from 'react';\nimport { notificarErro, notificarSucesso } from '../Notificacao/index';\nimport api from '../../../service/api';\nimport { Form, Button, Select, Input } from 'antd';\nimport { useHistory } from 'react-router-dom';\n\nfunction FormUsuario({\n  atualizar,\n  location\n}) {\n  const [usuario, setUsuario] = useState({});\n  const [tipoCadastro, setTipoCadastro] = useState(0);\n  const [carregado, setCarregado] = useState(false);\n  const categorias = ['Funcionario', 'Cliente'];\n  const history = useHistory();\n  useEffect(() => {\n    async function buscaUsuario() {\n      if (location) {\n        const params = new URLSearchParams(location.search);\n        const k = params.get('key');\n        const t = params.get('tipo');\n        setTipoCadastro(parseInt(t));\n\n        if (k) {\n          try {\n            const {\n              data\n            } = await api.get(`/usuario/${k}`);\n            await setUsuario(data);\n            await setCarregado(true);\n          } catch (e) {}\n        }\n      }\n    }\n\n    buscaUsuario();\n  }, [location]);\n\n  const cadastrarUsuario = async usuario => {\n    try {\n      await api.post('/usuario', {\n        usuario\n      });\n      notificarSucesso('O usuário foi cadastrado com sucesso.');\n      setTimeout(() => {\n        history.push('/usuarios');\n      }, 200);\n    } catch (e) {\n      const {\n        mensagem\n      } = e.response.data;\n      notificarErro(mensagem);\n    }\n  };\n\n  const editarUsuario = async usuario => {\n    try {\n      await api.put('/usuario', {\n        usuario\n      });\n      notificarSucesso('O usuário foi atualizado com sucesso.');\n      setTimeout(() => {\n        history.push('/usuarios');\n      }, 200);\n    } catch (e) {\n      const {\n        mensagem\n      } = e.response.data;\n      notificarErro(mensagem);\n    }\n  };\n\n  const onFormLayoutChange = ({\n    size\n  }) => {\n    console.log('formChange');\n  };\n\n  const onFinish = async values => {\n    const {\n      nome,\n      funcao,\n      cpfCnpj,\n      senha,\n      confirmSenha\n    } = values;\n\n    if (senha !== confirmSenha) {\n      notificarErro('As senhas não são iguais');\n    } else {\n      const usuarioC = {\n        nome,\n        funcao,\n        cpfCnpj,\n        senha,\n        tipoCadastro\n      };\n      cadastrarUsuario(usuarioC);\n    }\n  };\n\n  const onFinishEdit = async values => {\n    const {\n      nome,\n      funcao,\n      cpfCnpj,\n      senha,\n      confirmSenha\n    } = values;\n\n    if (senha && senha !== confirmSenha) {\n      notificarErro('As senhas não são iguais');\n    } else {\n      if (nome && funcao && cpfCnpj) {\n        const usuarioEdit = {\n          nome,\n          funcao,\n          senha\n        };\n        editarUsuario(usuarioEdit);\n      }\n    }\n  };\n\n  const onFinishFailed = errorInfo => {\n    console.log('Failed:', errorInfo);\n  };\n\n  const layout = {\n    labelCol: {\n      span: 5\n    },\n    wrapperCol: {\n      span: 16\n    }\n  };\n  const tailLayout = {\n    wrapperCol: {\n      offset: 5,\n      span: 16\n    }\n  };\n\n  const validarCpfCnpj = value => {\n    let retorno = Promise.resolve();\n    const regexCpf = '^[0-9]{3}[.][0-9]{3}[.][0-9]{3}[-][0-9]{2}$';\n    const regexCnpj = '^[0-9]{3}[.][0-9]{3}[.][0-9]{3}[/][0-9]{4}[-][0-9]{2}$';\n\n    if (value) {\n      console.log('Tipo: ' + tipoCadastro);\n\n      if (tipoCadastro === 0) {\n        if (value.match(regexCpf)) {\n          return Promise.resolve();\n        } else {\n          return Promise.reject('O CPF não se encontra no formato: xxx.xxx.xxx-xx');\n        }\n      } else if (tipoCadastro === 1) {\n        if (value.match(regexCnpj)) {\n          console.log('math cnpj');\n          return Promise.resolve();\n        } else {\n          return Promise.reject('O Cnpj não se encontra no formato: xxx.xxx.xxx/xxxx-xx');\n        }\n      }\n    }\n\n    return Promise.resolve();\n  };\n\n  if (carregado) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(Form, Object.assign({}, layout, {\n      name: \"basic\",\n      initialValues: {\n        remember: true,\n        nome: usuario.nome,\n        funcao: usuario.funcao,\n        cpfCnpj: usuario.cpfCnpj\n      },\n      onFinish: onFinishEdit,\n      onFinishFailed: onFinishFailed,\n      onValuesChange: onFormLayoutChange,\n      size: \"larger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }), React.createElement(Form.Item, {\n      label: \"Nome\",\n      name: \"nome\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(Input, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    })), React.createElement(Form.Item, {\n      label: tipoCadastro === 0 ? 'Cpf' : 'Cnpj',\n      name: \"cpfCnpj\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(Input, {\n      readOnly: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    })), React.createElement(Form.Item, {\n      label: \"Fun\\xE7\\xE3o\",\n      name: \"funcao\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(Select, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, categorias.map(cat => {\n      return React.createElement(Select.Option, {\n        value: cat,\n        key: cat,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, cat);\n    }))), React.createElement(Form.Item, {\n      label: \"Senha\",\n      name: \"senha\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(Input.Password, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    })), React.createElement(Form.Item, {\n      label: \"Confirma\\xE7\\xE3o\",\n      name: \"confirmSenha\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(Input.Password, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    })), React.createElement(Form.Item, Object.assign({}, tailLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Atualizar\"), React.createElement(Button, {\n      type: \"danger\",\n      href: \"/usuarios\",\n      style: {\n        marginLeft: '2px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"Cancelar\"))));\n  } else {\n    return React.createElement(Form, Object.assign({}, layout, {\n      name: \"basic\",\n      initialValues: {\n        remember: true\n      },\n      onFinish: onFinish,\n      onFinishFailed: onFinishFailed,\n      onValuesChange: onFormLayoutChange,\n      size: \"larger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }), React.createElement(Form.Item, {\n      label: \"Nome\",\n      name: \"nome\",\n      rules: [{\n        required: true,\n        message: 'O nome é obrigatorio!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, React.createElement(Input, {\n      id: \"nomeId\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    })), React.createElement(Form.Item, {\n      label: tipoCadastro === 0 ? 'Cpf' : 'Cnpj',\n      name: \"cpfCnpj\",\n      rules: [{\n        required: true,\n        message: `O ${tipoCadastro === 0 ? 'Cpf' : 'Cnpj'} é obrigatorio!`\n      }, () => ({\n        validator(_, value) {\n          return validarCpfCnpj(value);\n        }\n\n      })],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    }, React.createElement(Input, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    })), React.createElement(Form.Item, {\n      label: \"Fun\\xE7\\xE3o\",\n      name: \"funcao\",\n      rules: [{\n        required: true,\n        message: 'A Função é obrigatoria!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    }, React.createElement(Select, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, categorias.map(cat => {\n      return React.createElement(Select.Option, {\n        value: cat,\n        key: cat,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, cat);\n    }))), React.createElement(Form.Item, {\n      label: \"Senha\",\n      name: \"senha\",\n      rules: [{\n        required: true,\n        message: 'A senha é obrigatoria!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, React.createElement(Input.Password, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    })), React.createElement(Form.Item, {\n      label: \"Confirma\\xE7\\xE3o\",\n      name: \"confirmSenha\",\n      rules: [{\n        required: true,\n        message: 'A confirmação da senha é obrigatoria!'\n      }, ({\n        getFieldValue\n      }) => ({\n        validator(rule, value) {\n          if (!value || getFieldValue('senha') === value) {\n            return Promise.resolve();\n          }\n\n          return Promise.reject('As senhas não são iguais!');\n        }\n\n      })],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, React.createElement(Input.Password, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    })), React.createElement(Form.Item, Object.assign({}, tailLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, \"Salvar\"), React.createElement(Button, {\n      type: \"danger\",\n      href: \"/usuarios\",\n      style: {\n        marginLeft: '2px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, \"Cancelar\")));\n  }\n}\n\nexport default FormUsuario;","map":{"version":3,"sources":["/home/samuel/Documentos/repositorios/ProjetoDevWeb/frontend/src/protected/components/FormUsuario/index.js"],"names":["React","useState","useEffect","notificarErro","notificarSucesso","api","Form","Button","Select","Input","useHistory","FormUsuario","atualizar","location","usuario","setUsuario","tipoCadastro","setTipoCadastro","carregado","setCarregado","categorias","history","buscaUsuario","params","URLSearchParams","search","k","get","t","parseInt","data","e","cadastrarUsuario","post","setTimeout","push","mensagem","response","editarUsuario","put","onFormLayoutChange","size","console","log","onFinish","values","nome","funcao","cpfCnpj","senha","confirmSenha","usuarioC","onFinishEdit","usuarioEdit","onFinishFailed","errorInfo","layout","labelCol","span","wrapperCol","tailLayout","offset","validarCpfCnpj","value","retorno","Promise","resolve","regexCpf","regexCnpj","match","reject","remember","map","cat","marginLeft","required","message","validator","_","getFieldValue","rule"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { notificarErro, notificarSucesso } from '../Notificacao/index';\nimport api from '../../../service/api';\nimport {\n    Form,\n    Button,\n    Select,\n    Input\n} from 'antd';\nimport { useHistory } from 'react-router-dom';\n\nfunction FormUsuario({ atualizar, location }) {\n\n    const [usuario, setUsuario] = useState({});\n    const [tipoCadastro, setTipoCadastro] = useState(0);\n    const [carregado, setCarregado] = useState(false);\n\n    const categorias = ['Funcionario', 'Cliente'];\n    const history = useHistory();\n\n    useEffect(() => {\n        async function buscaUsuario() {\n            if (location) {\n                const params = new URLSearchParams(location.search);\n                const k = params.get('key');\n                const t = params.get('tipo');\n                setTipoCadastro(parseInt(t));\n                if (k) {\n                    try {\n                        const { data } = await api.get(`/usuario/${k}`);\n                        await setUsuario(data);\n                        await setCarregado(true);\n                    } catch (e) {\n\n                    }\n                }\n            }\n        }\n        buscaUsuario();\n    }, [location]);\n\n    const cadastrarUsuario = async (usuario) => {\n        try {\n            await api.post('/usuario', { usuario });\n            notificarSucesso('O usuário foi cadastrado com sucesso.');\n            setTimeout(() => {\n                history.push('/usuarios');\n            }, 200);\n        } catch (e) {\n            const { mensagem } = e.response.data;\n            notificarErro(mensagem);\n        }\n    }\n\n    const editarUsuario = async (usuario) => {\n        try {\n            await api.put('/usuario', { usuario });\n            notificarSucesso('O usuário foi atualizado com sucesso.');\n            setTimeout(() => {\n                history.push('/usuarios');\n            }, 200);\n        } catch (e) {\n            const { mensagem } = e.response.data;\n            notificarErro(mensagem);\n        }\n    }\n\n    const onFormLayoutChange = ({ size }) => {\n        console.log('formChange');\n    };\n\n    const onFinish = async (values) => {\n\n        const { nome, funcao, cpfCnpj, senha, confirmSenha } = values;\n\n        if (senha !== confirmSenha) {\n            notificarErro('As senhas não são iguais');\n        } else {\n\n            const usuarioC = {\n                nome,\n                funcao,\n                cpfCnpj,\n                senha,\n                tipoCadastro\n            };\n            cadastrarUsuario(usuarioC);\n        }\n    };\n\n    const onFinishEdit = async (values) => {\n        const { nome, funcao, cpfCnpj, senha, confirmSenha } = values;\n        if (senha && senha !== confirmSenha) {\n            notificarErro('As senhas não são iguais');\n        } else {\n            if (nome && funcao && cpfCnpj) {\n                const usuarioEdit = {\n                    nome,\n                    funcao,\n                    senha,\n                };\n                editarUsuario(usuarioEdit);\n            }\n        }\n    };\n\n    const onFinishFailed = errorInfo => {\n        console.log('Failed:', errorInfo);\n    };\n\n    const layout = {\n        labelCol: {\n            span: 5,\n        },\n        wrapperCol: {\n            span: 16,\n        },\n    };\n    const tailLayout = {\n        wrapperCol: {\n            offset: 5,\n            span: 16,\n        },\n    };\n\n    const validarCpfCnpj = (value) => {\n        let retorno = Promise.resolve();\n        const regexCpf = '^[0-9]{3}[.][0-9]{3}[.][0-9]{3}[-][0-9]{2}$';\n        const regexCnpj = '^[0-9]{3}[.][0-9]{3}[.][0-9]{3}[/][0-9]{4}[-][0-9]{2}$';\n\n        if (value) {\n            console.log('Tipo: ' + tipoCadastro);\n            if (tipoCadastro === 0) {\n                if (value.match(regexCpf)) {\n                    return Promise.resolve();\n                } else {\n                    return Promise.reject('O CPF não se encontra no formato: xxx.xxx.xxx-xx');\n                }\n            } else if (tipoCadastro === 1) {\n                if (value.match(regexCnpj)) {\n                    console.log('math cnpj');\n                    return Promise.resolve();\n                } else {\n                    return Promise.reject('O Cnpj não se encontra no formato: xxx.xxx.xxx/xxxx-xx');\n                }\n            }\n        }\n        return Promise.resolve();\n    }\n\n    if (carregado) {\n        return (\n            <div>\n                <Form\n                    {...layout}\n                    name=\"basic\"\n                    initialValues={{\n                        remember: true,\n                        nome: usuario.nome,\n                        funcao: usuario.funcao,\n                        cpfCnpj: usuario.cpfCnpj\n                    }}\n                    onFinish={onFinishEdit}\n                    onFinishFailed={onFinishFailed}\n                    onValuesChange={onFormLayoutChange}\n                    size='larger'>\n                    <Form.Item\n                        label='Nome'\n                        name=\"nome\">\n                        <Input />\n                    </Form.Item>\n                    <Form.Item\n                        label={tipoCadastro === 0 ? 'Cpf' : 'Cnpj'}\n                        name=\"cpfCnpj\"\n\n\n                    >\n                        <Input readOnly />\n                    </Form.Item>\n                    <Form.Item\n                        label='Função'\n                        name=\"funcao\"\n\n                    >\n                        <Select>\n                            {\n                                categorias.map((cat) => {\n                                    return (<Select.Option value={cat} key={cat}>{cat}</Select.Option>)\n                                })\n                            }\n                        </Select>\n                    </Form.Item>\n\n                    <Form.Item\n                        label='Senha'\n                        name='senha'\n                    >\n                        <Input.Password />\n                    </Form.Item>\n\n                    <Form.Item\n                        label='Confirmação'\n                        name=\"confirmSenha\"\n                    >\n                        <Input.Password />\n                    </Form.Item>\n\n                    <Form.Item {...tailLayout}>\n                        <Button\n                            type=\"primary\"\n                            htmlType=\"submit\">\n                            Atualizar\n                        </Button>\n\n                        <Button\n                            type=\"danger\"\n                            href=\"/usuarios\"\n                            style={{ marginLeft: '2px' }}\n                        >\n                            Cancelar\n                        </Button>\n                    </Form.Item>\n                </Form>\n            </div>);\n    } else {\n\n        return (\n            <Form\n                {...layout}\n                name=\"basic\"\n                initialValues={{ remember: true }}\n                onFinish={onFinish}\n                onFinishFailed={onFinishFailed}\n                onValuesChange={onFormLayoutChange}\n                size='larger'>\n                <Form.Item\n                    label='Nome'\n                    name=\"nome\"\n                    rules={[\n                        {\n                            required: true,\n                            message: 'O nome é obrigatorio!'\n                        }]}\n                >\n                    <Input id='nomeId' />\n                </Form.Item>\n                <Form.Item\n                    label={tipoCadastro === 0 ? 'Cpf' : 'Cnpj'}\n                    name=\"cpfCnpj\"\n                    rules={[\n                        {\n                            required: true,\n                            message: `O ${tipoCadastro === 0 ? 'Cpf' : 'Cnpj'} é obrigatorio!`\n                        },\n                        () => ({\n                            validator(_, value) {\n                                return validarCpfCnpj(value);\n                            },\n                        }),\n\n                    ]}\n                >\n                    <Input />\n                </Form.Item>\n\n                <Form.Item\n                    label='Função'\n                    name=\"funcao\"\n                    rules={[\n                        {\n                            required: true,\n                            message: 'A Função é obrigatoria!',\n                        }]}\n                >\n                    <Select>\n                        {\n                            categorias.map((cat) => {\n                                return (<Select.Option value={cat} key={cat}>{cat}</Select.Option>)\n                            })\n                        }\n                    </Select>\n                </Form.Item>\n\n                <Form.Item\n                    label='Senha'\n                    name=\"senha\"\n                    rules={[\n                        {\n                            required: true,\n                            message: 'A senha é obrigatoria!'\n                        }]}\n                >\n                    <Input.Password />\n                </Form.Item>\n\n                <Form.Item\n                    label='Confirmação'\n                    name=\"confirmSenha\"\n                    rules={[\n                        {\n                            required: true,\n                            message: 'A confirmação da senha é obrigatoria!'\n                        },\n                        ({ getFieldValue }) => ({\n                            validator(rule, value) {\n                                if (!value || getFieldValue('senha') === value) {\n                                    return Promise.resolve();\n                                }\n\n                                return Promise.reject('As senhas não são iguais!');\n                            },\n                        }),\n                    ]}\n                >\n                    <Input.Password />\n                </Form.Item>\n\n                <Form.Item {...tailLayout}>\n                    <Button\n                        type=\"primary\"\n                        htmlType=\"submit\">\n                        Salvar\n                    </Button>\n                    <Button\n                        type=\"danger\"\n                        href=\"/usuarios\"\n                        style={{ marginLeft: '2px' }}\n                    >\n                        Cancelar\n                        </Button>\n                </Form.Item>\n            </Form>\n        );\n    }\n}\n\nexport default FormUsuario;"]},"metadata":{},"sourceType":"module"}