{"ast":null,"code":"var _jsxFileName = \"/home/samuel/Documentos/repositorios/ProjetoDevWeb/frontend/src/protected/pages/Pedidos/index.js\";\nimport React, { useEffect, useState } from 'react';\nimport TabelaPedidos from '../../components/TabelaPedidos';\nimport Titulo from '../../components/Titulo';\nimport { CloseOutlined, SearchOutlined, ReloadOutlined, CheckOutlined } from '@ant-design/icons';\nimport { Container, Breadcrumb } from 'react-bootstrap';\nimport { Divider, Button, Modal, Form, DatePicker } from 'antd';\nimport { showConfirm } from '../../components/ConfirmAcao';\nimport { notificarErro, notificarSucesso } from '../../components/Notificacao';\nimport { getKeyUsuarioLogado, isFuncionarioLogado, isClienteLogado } from '../../../service/usuario';\nimport FooterButtons from '../../components/FooterButtons';\nimport api from '../../../service/api';\nimport { useHistory } from 'react-router-dom';\nconst {\n  Item\n} = Breadcrumb;\n\nfunction Pedidos() {\n  const [handlerUpdateTable, setHandlerUpdateTable] = useState(false);\n  const [modalVisible, setModalVisible] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [data, setData] = useState('');\n  const [dateString, setDateString] = useState('');\n  const [pedido, setPedido] = useState({});\n  const history = useHistory();\n  const [clienteLogado, setClienteLogado] = useState(false);\n  const [funcionarioLogado, setFuncionarioLogado] = useState(false);\n  useEffect(() => {\n    const verificarUsuarioLogado = async () => {\n      const clienteLogado = await isClienteLogado();\n      setClienteLogado(clienteLogado);\n      setFuncionarioLogado(!clienteLogado);\n    };\n  }, []);\n\n  const buscarPedidos = async () => {\n    const {\n      data\n    } = await api.get('/pedido', {\n      params: {\n        keyUsuario: getKeyUsuarioLogado()\n      }\n    });\n    return data;\n  };\n\n  const acoes = {\n    title: 'Ações',\n    dataIndex: 'acoes',\n    key: 'acoes',\n    render: (_, record) => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        margin: '1px'\n      },\n      icon: /*#__PURE__*/React.createElement(SearchOutlined, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 27\n        }\n      }),\n      title: \"Ver Pedido\",\n      onClick: _ => {\n        handlerVisualizar(record.key);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 17\n      }\n    }), record.status === 'REALIZADO' && /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        margin: '1px'\n      },\n      danger: true,\n      title: \"Cancelar Pedido\",\n      icon: /*#__PURE__*/React.createElement(CloseOutlined, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 31\n        }\n      }),\n      onClick: _ => {\n        showConfirm(\"Cancelar Pedido\", \"Deseja Cancelar o pedido?\", cancelarPedido, record.key);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 21\n      }\n    }), record.status === 'FINALIZADO' && isClienteLogado() && /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        margin: '1px'\n      },\n      title: \"Repetir Pedido\",\n      icon: /*#__PURE__*/React.createElement(ReloadOutlined, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 31\n        }\n      }),\n      onClick: _ => {\n        repetirPedido(record);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 21\n      }\n    }), record.status === 'REALIZADO' && isFuncionarioLogado() && /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        margin: '1px'\n      },\n      title: \"Aceitar Pedido\",\n      icon: /*#__PURE__*/React.createElement(CheckOutlined, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 31\n        }\n      }),\n      onClick: _ => {\n        repetirPedido(record);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 21\n      }\n    }))\n  };\n\n  const cancelarPedido = async key => {\n    try {\n      await api.delete(`/pedido/${key}`, {\n        params: {\n          keyUsuario: getKeyUsuarioLogado()\n        }\n      });\n      notificarSucesso('Pedido cancelado com sucesso!');\n      setHandlerUpdateTable(!handlerUpdateTable);\n    } catch (e) {\n      const {\n        mensagem\n      } = e.response.data;\n      notificarErro(mensagem);\n    }\n  };\n\n  const repetirPedido = record => {\n    setPedido(record);\n    showConfirm(\"Repetir Pedido\", \"Deseja repetir o pedido?\", abrirModal);\n  };\n\n  const abrirModal = () => {\n    setModalVisible(true);\n    setLoading(false);\n  };\n\n  const confirmRepetir = async () => {\n    setLoading(true);\n\n    if (dateString) {\n      try {\n        await api.post(`/pedido/renovar/${pedido.key}`, {}, {\n          params: {\n            keyUsuario: getKeyUsuarioLogado(),\n            data: dateString\n          }\n        });\n        notificarSucesso('Pedido refeito com sucesso.');\n        setModalVisible(false);\n      } catch (e) {\n        const {\n          mensagem\n        } = e.response.data;\n        notificarErro(mensagem);\n      }\n    } else {\n      notificarErro('Selecione a data.');\n    }\n\n    setLoading(false);\n  };\n\n  const handleCancel = () => {\n    setModalVisible(false);\n    setLoading(false);\n  };\n\n  const layout = {\n    labelCol: {\n      span: 5\n    },\n    wrapperCol: {\n      span: 5\n    }\n  };\n  const tailLayout = {\n    wrapperCol: {\n      offset: 2,\n      span: 10\n    }\n  };\n\n  const onChangeData = (date, dateString) => {\n    const dataSelecionada = new Date(date).getTime();\n    const dataAtual = new Date().getTime();\n\n    if (dataSelecionada < dataAtual) {\n      if (dataSelecionada === 0) {\n        setData('');\n        setDateString('');\n      } else {\n        notificarErro('Data Inválida.');\n      }\n    } else {\n      setData(date);\n      setDateString(dateString);\n    }\n  };\n\n  const handlerCadastrar = () => {\n    history.push({\n      pathname: '/perfilPedidos',\n      search: '?cadastro=1'\n    });\n  };\n\n  const handlerVisualizar = key => {\n    history.push({\n      pathname: '/perfilPedidos',\n      search: `?cadastro=0&key=${key}`\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Breadcrumb, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Item, {\n    href: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  }, \"Principal\"), /*#__PURE__*/React.createElement(Item, {\n    active: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 17\n    }\n  }, \"Pedidos\")), /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Titulo, {\n    nome: \"Pedidos\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(TabelaPedidos, {\n    getData: buscarPedidos,\n    acoes: acoes,\n    handlerUpdateTable: handlerUpdateTable,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(FooterButtons, {\n    label1: \"Cadastrar\",\n    label2: \"Voltar\",\n    callback1: handlerCadastrar,\n    callback2: history.goBack,\n    visible1: isClienteLogado(),\n    visible2: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Modal, {\n    title: \"Data do Pedido\",\n    visible: modalVisible,\n    footer: [/*#__PURE__*/React.createElement(Button, {\n      key: \"back\",\n      onClick: handleCancel,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }\n    }, \"Cancelar\"), /*#__PURE__*/React.createElement(Button, {\n      key: \"submit\",\n      type: \"primary\",\n      loading: loading,\n      onClick: confirmRepetir,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 21\n      }\n    }, \"Ok\")],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form, Object.assign({}, layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Form.Item, Object.assign({}, tailLayout, {\n    label: \"Data: \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(DatePicker, {\n    value: data,\n    onChange: onChangeData,\n    format: 'DD/MM/YYYY',\n    locale: 'pt-BR',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 25\n    }\n  })))));\n}\n\nexport default Pedidos;","map":{"version":3,"sources":["/home/samuel/Documentos/repositorios/ProjetoDevWeb/frontend/src/protected/pages/Pedidos/index.js"],"names":["React","useEffect","useState","TabelaPedidos","Titulo","CloseOutlined","SearchOutlined","ReloadOutlined","CheckOutlined","Container","Breadcrumb","Divider","Button","Modal","Form","DatePicker","showConfirm","notificarErro","notificarSucesso","getKeyUsuarioLogado","isFuncionarioLogado","isClienteLogado","FooterButtons","api","useHistory","Item","Pedidos","handlerUpdateTable","setHandlerUpdateTable","modalVisible","setModalVisible","loading","setLoading","data","setData","dateString","setDateString","pedido","setPedido","history","clienteLogado","setClienteLogado","funcionarioLogado","setFuncionarioLogado","verificarUsuarioLogado","buscarPedidos","get","params","keyUsuario","acoes","title","dataIndex","key","render","_","record","margin","handlerVisualizar","status","cancelarPedido","repetirPedido","delete","e","mensagem","response","abrirModal","confirmRepetir","post","handleCancel","layout","labelCol","span","wrapperCol","tailLayout","offset","onChangeData","date","dataSelecionada","Date","getTime","dataAtual","handlerCadastrar","push","pathname","search","goBack"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport TabelaPedidos from '../../components/TabelaPedidos';\nimport Titulo from '../../components/Titulo';\nimport { CloseOutlined, SearchOutlined, ReloadOutlined, CheckOutlined} from '@ant-design/icons';\nimport { Container, Breadcrumb } from 'react-bootstrap';\nimport { Divider, Button, Modal, Form, DatePicker } from 'antd';\nimport { showConfirm } from '../../components/ConfirmAcao';\nimport { notificarErro, notificarSucesso } from '../../components/Notificacao';\nimport { getKeyUsuarioLogado, isFuncionarioLogado, isClienteLogado} from '../../../service/usuario';\nimport FooterButtons from '../../components/FooterButtons';\nimport api from '../../../service/api';\nimport {useHistory} from 'react-router-dom';\nconst { Item } = Breadcrumb;\n\n\nfunction Pedidos() {\n\n    const [handlerUpdateTable, setHandlerUpdateTable] = useState(false);\n    const [modalVisible, setModalVisible] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [data, setData] = useState('');\n    const [dateString, setDateString] = useState('');\n    const [pedido, setPedido] = useState({});\n    const history = useHistory();\n\n    const [clienteLogado, setClienteLogado] = useState(false);\n    const [funcionarioLogado, setFuncionarioLogado] = useState(false);\n\n    useEffect(() => {\n        const verificarUsuarioLogado = async () => {\n            const clienteLogado = await isClienteLogado();\n            setClienteLogado(clienteLogado);\n            setFuncionarioLogado(!clienteLogado);\n        }\n        \n    }, []);\n\n   \n\n    const buscarPedidos = async () => {\n        const { data } = await api.get('/pedido', { params: { keyUsuario: getKeyUsuarioLogado() } });\n        return data;\n\n    }\n\n    const acoes = {\n        title: 'Ações',\n        dataIndex: 'acoes',\n        key: 'acoes',\n        render: (_, record) => (\n            <span>\n                <Button\n                    type='primary'\n                    style={{ margin: '1px' }}\n                    icon={<SearchOutlined />}\n                    title='Ver Pedido'\n                    onClick={_ => { handlerVisualizar(record.key) }}\n                />\n                {record.status === 'REALIZADO' &&\n                    <Button\n                        type='primary'\n                        style={{ margin: '1px' }}\n                        danger\n                        title='Cancelar Pedido'\n                        icon={<CloseOutlined />}\n                        onClick={_ => {\n                            showConfirm(\"Cancelar Pedido\", \"Deseja Cancelar o pedido?\", cancelarPedido, record.key);\n                        }\n                        }\n                    />\n                }\n                {(record.status === 'FINALIZADO' && isClienteLogado()) &&\n                    <Button\n                        type='primary'\n                        style={{ margin: '1px'}}\n                        title='Repetir Pedido'\n                        icon={<ReloadOutlined />}\n                        onClick={_ => { repetirPedido(record) }}\n                    />\n                }\n                {(record.status === 'REALIZADO' && isFuncionarioLogado()) &&\n                    <Button\n                        type='primary'\n                        style={{ margin: '1px' }}\n                        title='Aceitar Pedido'\n                        icon={<CheckOutlined />}\n                        onClick={_ => { repetirPedido(record) }}\n                    />\n                }\n            </span>\n        )\n    };\n\n    const cancelarPedido = async (key) => {\n        try {\n            await api.delete(`/pedido/${key}`, { params: { keyUsuario: getKeyUsuarioLogado() } });\n            notificarSucesso('Pedido cancelado com sucesso!');\n            setHandlerUpdateTable(!handlerUpdateTable);\n        } catch (e) {\n            const { mensagem } = e.response.data;\n            notificarErro(mensagem);\n        }\n    }\n\n    const repetirPedido = (record) => {\n        setPedido(record);\n        showConfirm(\"Repetir Pedido\", \"Deseja repetir o pedido?\", abrirModal);\n    }\n\n    const abrirModal = () => {\n        setModalVisible(true);\n        setLoading(false);\n    }\n\n    const confirmRepetir = async () => {\n        setLoading(true);\n        if (dateString) {\n            try {\n                await api.post(`/pedido/renovar/${pedido.key}`, {}, {\n                    params: {\n                        keyUsuario: getKeyUsuarioLogado(),\n                        data: dateString\n                    }\n                });\n                notificarSucesso('Pedido refeito com sucesso.');\n                setModalVisible(false);\n\n            } catch (e) {\n                const { mensagem } = e.response.data;\n                notificarErro(mensagem);\n            }\n        } else {\n            notificarErro('Selecione a data.');\n        }\n        setLoading(false);\n    }\n\n    const handleCancel = () => {\n        setModalVisible(false);\n        setLoading(false);\n    }\n\n    const layout = {\n        labelCol: {\n            span: 5,\n        },\n        wrapperCol: {\n            span: 5,\n        },\n    };\n\n    const tailLayout = {\n        wrapperCol: {\n            offset: 2,\n            span: 10,\n        },\n    };\n\n    const onChangeData = (date, dateString) => {\n        const dataSelecionada = new Date(date).getTime();\n        const dataAtual = new Date().getTime();\n        if (dataSelecionada < dataAtual) {\n            if(dataSelecionada === 0){\n                setData('');\n                setDateString('');\n            }else{\n                notificarErro('Data Inválida.');\n            }\n        } else {\n            setData(date);\n            setDateString(dateString);\n        }\n    }\n\n    const handlerCadastrar = () => {\n        history.push({\n            pathname:'/perfilPedidos',\n            search:'?cadastro=1' \n        });\n    }\n\n    const handlerVisualizar = (key) => {\n        history.push({\n            pathname:'/perfilPedidos',\n            search:`?cadastro=0&key=${key}` \n        });\n    }\n\n    return (\n        <div>\n            <Breadcrumb>\n                <Item href=\"/\">Principal</Item>\n                <Item active>Pedidos</Item>\n            </Breadcrumb>\n            <Container>\n                <Titulo nome=\"Pedidos\" />\n                <Divider />\n                <TabelaPedidos getData={buscarPedidos} acoes={acoes} handlerUpdateTable={handlerUpdateTable} />\n                <Divider />\n                <FooterButtons label1='Cadastrar' label2='Voltar' callback1={handlerCadastrar} callback2={history.goBack} visible1={isClienteLogado()} visible2={false}/>\n            </Container>\n            <Modal\n                title=\"Data do Pedido\"\n                visible={modalVisible}\n                footer={[\n                    <Button key=\"back\" onClick={handleCancel}>\n                        Cancelar\n                        </Button>,\n                    <Button key=\"submit\" type=\"primary\" loading={loading} onClick={confirmRepetir}>\n                        Ok\n                        </Button>,\n                ]}\n\n            >\n                <Form {...layout}>\n                    <Form.Item\n                        {...tailLayout}\n                        label='Data: '>\n                        <DatePicker value={data} onChange={onChangeData} format={'DD/MM/YYYY'} locale={'pt-BR'} />\n                    </Form.Item>\n\n                </Form>\n            </Modal>\n        </div>\n    );\n}\n\nexport default Pedidos;"]},"metadata":{},"sourceType":"module"}